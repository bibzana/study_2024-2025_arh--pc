---
## Front matter
title: "Лабораторная работа №9"
subtitle: "дисциплина:	Архитектура компьютера"
author: "Кондрацкая Александра Евгеньевна"

## Generic otions
lang: ru-RU
toc-title: "Оглавление"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true # Table of contents
toc-depth: 2
lof: true # List of figures
lot: true # List of tables
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
	- spelling=modern
	- babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float} # keep figures where there are in the text
  - \floatplacement{figure}{H} # keep figures where there are in the text
---

# Цель работы

Цель данного задания — освоить практические навыки разработки программ с использованием подпрограмм, а также изучить основы отладки программ с помощью GDB и его ключевые функциональные возможности.

# Задание

    • Освоить реализацию подпрограмм в NASM
    • Освоить отладку программам с помощью GDB
    • Работа с данными программы GDB
    • Обработать вргументы командной строки в GDB

# Выполнение лабораторной работы

Создадим каталог для выполнения лабораторной работы № 9, перейдём в него и со-
здадим файл lab09-1.asm (рис. 1)






Введём в файл lab09-1.asm текст программы из листинга 9.1 (рис. 2)
















 

Создадим исполняемый файл и проверим его работу (рис. 3)





Внесем изменения в программу (рис. 4+5)



























Создадим исполняемый файл и проверим (рис. 6)


Создадим файл lab09-2.asm (рис. 7)






Введем в него текст программы из листинга 9.2 (рис. 8)






Создадим исполняемый файл и проверим (рис. 9)


Для работы с GDB в исполняемый файл необходимо добавить отладочную информацию, для этого трансляцию программ необходимо проводить с ключом ‘-g’. (рис. 10)


Загрузим исполняемый файл в отладчик gdb и проверим работу программы, запустив ее в оболочке GDB с помощью команды run (рис 11).
 




Для более подробного анализа программы установиv брейкпоинт на метку _start, с
которой начинается выполнение любой ассемблерной программы, и запустиv её (рис. 12)


Посмотрим дисассимилированный код программы с помощью команды disassemble
начиная с метки _start (рис. 13)













Переключимся на отображение команд с Intel’овским синтаксисом, введя команду set
disassembly-flavor intel (рис. 14)














Главное отличие между этими двумя способами представления команд заключается в использовании символов % и $ для обозначения регистров в дизассемблированном виде. В Intel-синтаксисе этих символов нет, что упрощает восприятие кода.
Включим режим псевдографики для более удобного анализа программы (рис. 15)

Определим адрес предпоследней инструкции (mov ebx,0x0), установим точку останова и посмотрим информацию о всех установленных точках останова (рис.16)

















Посмотрим значение переменной msg1 по имени (рис. 17)




Посмотрим значение переменной msg2 по адресу (рис. 18)







Изменим первый символ переменной msg1 (рис. 19)





Заменим любой символ во второй переменной msg2 (рис. 20)






С помощью команды set изменим значение регистра ebx (рис. 21)







Команда выводит два разных значения, потому что в первый раз указывается значение 2, а во второй раз регистр равен двум, поэтому и значения отличаются.



Скопируем файл lab8-2.asm, созданный при выполнении лабораторной работы №8 (рис. 22)

Создадим исполняемый файл (рис. 23)


Для загрузки в gdb программы с аргументами необходимо использовать ключ --args.
Загрузим исполняемый файл в отладчик, указав аргументы (рис. 24)


Для начала установим точку останова перед первой инструкцией в программе и запустим ее (рис. 25)



Адрес вершины стека храниться в регистре esp и по этому адресу располагается число
равное количеству аргументов командной строки (включая имя программы) (рис. 26)




Их ровно 5.
Посмотрите остальные позиции стека (рис. 27)



Первый адрес стека содержит указатель на начало данных, а следующие  — 
данные с шагом 4 байта (размер элемента).Для избежания конфликтов, каждое
значение записывается в новый стек.


САМОСТОЯТЕЛЬНАЯ РАБОТА
Создадим файл (рис. 28)


1) Введем измененную программу (рис. 29)























Создадим исполняемый файл и проверим (рис. 30)


2) Создадим еще один файл (рис. 31)


Введем в него программу из листинга (рис. 32)

















Создадим исполняемый файл (рис. 33)



Откроем откладчик и увидим, что регистры стоят не на своих местах (рис. 34)










Исправим это (рис. 35)



















Создадим исполняемый файл и проверим (рис. 36)


# Выводы

В результате выполнения задания были приобретены навыки программирования с применением подпрограмм. Изучены базовые методы отладки программ с помощью GDB и освоены его основные функции.
